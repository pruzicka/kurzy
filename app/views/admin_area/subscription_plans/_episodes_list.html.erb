<div id="episodes_list">
  <% episodes = subscription_plan.episodes.ordered %>
  <% if episodes.any? %>
    <div class="mt-4 divide-y divide-gray-100">
      <% episodes.each do |episode| %>
        <div class="flex items-center justify-between gap-4 py-3">
          <div class="flex items-center gap-3">
            <span class="inline-flex h-7 w-7 items-center justify-center rounded-lg bg-gray-100 text-xs font-semibold text-gray-700"><%= episode.position %></span>
            <div>
              <div class="flex flex-wrap items-center gap-1.5">
                <span class="font-medium text-gray-900"><%= episode.title %></span>
                <% if episode.video_attached? %>
                  <span class="inline-flex items-center" title="Má video">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-4 w-4 text-gray-400" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5 19.5 8.25v7.5l-3.75-2.25" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 6.75h9A2.25 2.25 0 0 1 15.75 9v6A2.25 2.25 0 0 1 13.5 17.25h-9A2.25 2.25 0 0 1 2.25 15V9A2.25 2.25 0 0 1 4.5 6.75Z" />
                    </svg>
                  </span>
                <% end %>
                <% if episode.audio_attached? %>
                  <span class="inline-flex items-center" title="Má audio">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-4 w-4 text-gray-400" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 9l10.5-3v13.5" />
                      <circle cx="6.75" cy="17.25" r="2.25" />
                      <circle cx="17.25" cy="15.75" r="2.25" />
                    </svg>
                  </span>
                <% end %>
                <% if episode.effective_cover_blob.present? %>
                  <span class="inline-flex items-center" title="Má náhled">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-4 w-4 text-gray-400" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75V6A2.25 2.25 0 0 1 4.5 3.75h15A2.25 2.25 0 0 1 21.75 6v9.75A2.25 2.25 0 0 1 19.5 18H4.5A2.25 2.25 0 0 1 2.25 15.75Z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 14.25 7.5 11.25l3 3 4.5-4.5 4.5 4.5" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 8.25h.01" />
                    </svg>
                  </span>
                <% end %>
                <% if episode.attachments.attached? %>
                  <span class="inline-flex items-center" title="Má přílohy">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-4 w-4 text-gray-400" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M18.375 12.739V7.5a4.125 4.125 0 0 0-8.25 0v8.625a2.625 2.625 0 0 0 5.25 0V8.625a1.125 1.125 0 0 0-2.25 0v7.5" />
                    </svg>
                  </span>
                <% end %>
              </div>
              <div class="mt-0.5 text-xs text-gray-600">
                <% badge =
                  case episode.status
                  when "published" then "bg-emerald-50 text-emerald-900 border-emerald-200"
                  else "bg-amber-50 text-amber-900 border-amber-200"
                  end
                %>
                <span class="inline-flex rounded-full border px-2 py-0.5 text-[10px] font-medium <%= badge %>"><%= episode.status %></span>
              </div>
            </div>
          </div>
          <div class="flex items-center gap-1">
            <%= button_to move_up_admin_subscription_plan_episode_path(subscription_plan, episode), method: :patch, class: "rounded-lg border border-gray-300 bg-white p-1.5 text-gray-700 hover:bg-gray-50" do %>
              <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" /></svg>
            <% end %>
            <%= button_to move_down_admin_subscription_plan_episode_path(subscription_plan, episode), method: :patch, class: "rounded-lg border border-gray-300 bg-white p-1.5 text-gray-700 hover:bg-gray-50" do %>
              <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
            <% end %>
            <%= link_to "Upravit", edit_admin_subscription_plan_episode_path(subscription_plan, episode), class: "rounded-lg border border-gray-300 bg-white px-2.5 py-1.5 text-xs font-medium text-gray-900 hover:bg-gray-50" %>
            <%= button_to "Smazat", admin_subscription_plan_episode_path(subscription_plan, episode), method: :delete, data: { turbo_confirm: "Smazat epizodu?" }, class: "rounded-lg border border-rose-200 bg-rose-50 px-2.5 py-1.5 text-xs font-medium text-rose-900 hover:bg-rose-100" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="mt-4 text-sm text-gray-500">Zatím žádné epizody.</p>
  <% end %>
</div>
