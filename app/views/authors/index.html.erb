<% content_for :title, "Autoři" %>

<div class="w-full">
  <div class="flex items-end justify-between gap-4">
    <h1 class="text-3xl font-semibold tracking-tight">Autoři</h1>
    <%= link_to "Zpět na úvod", root_path, class: "text-sm font-medium text-gray-900 hover:underline" %>
  </div>

  <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-2">
    <% @authors.each do |author| %>
      <%= link_to author_path(author.slug), class: "group rounded-2xl border border-gray-200 bg-white p-6 shadow-sm hover:border-gray-300" do %>
        <div class="flex items-center gap-4">
          <% if author.profile_image.attached? %>
            <% thumb = (author.profile_image.variant(resize_to_fill: [96, 96]).processed rescue nil) %>
            <% if thumb %>
              <%= image_tag thumb, class: "h-16 w-16 shrink-0 rounded-full border border-gray-200 object-cover" %>
            <% else %>
              <%= image_tag rails_blob_path(author.profile_image, disposition: "inline"), class: "h-16 w-16 shrink-0 rounded-full border border-gray-200 object-cover" %>
            <% end %>
          <% else %>
            <span class="inline-flex h-16 w-16 shrink-0 items-center justify-center rounded-full bg-gray-900 text-lg font-semibold text-white">
              <%= author.first_name.first.upcase %>
            </span>
          <% end %>
          <div>
            <h2 class="text-lg font-semibold tracking-tight group-hover:underline"><%= author.name %></h2>
            <% course_count = author.courses.publicly_visible.count %>
            <% plan_count = author.subscription_plans.publicly_visible.count %>
            <p class="mt-1 text-sm text-gray-600">
              <% parts = [] %>
              <% parts << pluralize(course_count, "kurz", "kurzy") if course_count.positive? %>
              <% parts << pluralize(plan_count, "předplatné", "předplatné") if plan_count.positive? %>
              <%= parts.join(" · ") %>
            </p>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <% if @authors.empty? %>
    <div class="mt-6 rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-8 text-gray-700">
      Zatím nejsou k dispozici žádní autoři.
    </div>
  <% end %>
</div>
