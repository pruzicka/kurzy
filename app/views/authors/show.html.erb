<% content_for :title, @author.name %>

<div class="w-full">
  <div class="flex flex-col items-center gap-4 sm:flex-row sm:items-start">
    <% if @author.profile_image.attached? %>
      <% thumb = (@author.profile_image.variant(resize_to_fill: [200, 200]).processed rescue nil) %>
      <% if thumb %>
        <%= image_tag thumb, class: "h-32 w-32 shrink-0 rounded-full border border-gray-200 object-cover" %>
      <% else %>
        <%= image_tag rails_blob_path(@author.profile_image, disposition: "inline"), class: "h-32 w-32 shrink-0 rounded-full border border-gray-200 object-cover" %>
      <% end %>
    <% end %>
    <div>
      <h1 class="text-3xl font-semibold tracking-tight"><%= @author.name %></h1>
      <% if @author.bio&.body&.present? %>
        <div class="mt-3 prose prose-sm prose-gray max-w-none">
          <%= @author.bio %>
        </div>
      <% end %>
    </div>
  </div>

  <% if @courses.any? %>
    <h2 class="mt-10 text-2xl font-semibold tracking-tight">Kurzy</h2>
    <div class="mt-4 grid grid-cols-1 gap-4 md:grid-cols-2">
      <% @courses.each do |course| %>
        <div class="group rounded-2xl border border-gray-200 bg-white p-6 shadow-sm hover:border-gray-300">
          <div class="flex flex-col gap-3">
            <% if course.cover_image.attached? %>
              <% thumb = (course.cover_image.variant(resize_to_fill: [1200, 675]).processed rescue nil) %>
              <%= link_to course_path(course), class: "overflow-hidden rounded-2xl border border-gray-200 bg-white" do %>
                <% if thumb %>
                  <%= image_tag thumb, class: "h-40 w-full object-cover" %>
                <% else %>
                  <%= image_tag rails_blob_path(course.cover_image, disposition: "inline"), class: "h-40 w-full object-cover" %>
                <% end %>
              <% end %>
            <% end %>
            <div class="flex items-start justify-between gap-4">
              <h3 class="text-lg font-semibold tracking-tight">
                <%= link_to course.name, course_path(course), class: "hover:underline" %>
              </h3>
              <span class="shrink-0 rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-700">
                <%= number_to_currency(course.price, unit: course.currency, precision: course.display_precision) %>
              </span>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

  <% if @subscription_plans.any? %>
    <h2 class="mt-10 text-2xl font-semibold tracking-tight">Předplatné</h2>
    <div class="mt-4 grid grid-cols-1 gap-4 md:grid-cols-2">
      <% @subscription_plans.each do |plan| %>
        <div class="group rounded-2xl border border-gray-200 bg-white p-6 shadow-sm hover:border-gray-300">
          <div class="flex flex-col gap-3">
            <% if plan.cover_image.attached? %>
              <% thumb = (plan.cover_image.variant(resize_to_fill: [1200, 675]).processed rescue nil) %>
              <%= link_to subscription_plan_path(plan.slug), class: "overflow-hidden rounded-2xl border border-gray-200 bg-white" do %>
                <% if thumb %>
                  <%= image_tag thumb, class: "h-40 w-full object-cover" %>
                <% else %>
                  <%= image_tag rails_blob_path(plan.cover_image, disposition: "inline"), class: "h-40 w-full object-cover" %>
                <% end %>
              <% end %>
            <% end %>
            <div class="flex items-start justify-between gap-4">
              <h3 class="text-lg font-semibold tracking-tight">
                <%= link_to plan.name, subscription_plan_path(plan.slug), class: "hover:underline" %>
              </h3>
              <span class="shrink-0 rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-700">
                od <%= number_to_currency(plan.monthly_price, unit: plan.currency, precision: 0) %>/měs
              </span>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
