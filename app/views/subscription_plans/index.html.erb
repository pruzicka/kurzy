<% content_for :title, "Předplatné" %>

<div class="w-full">
  <div class="flex items-end justify-between gap-4">
    <h1 class="text-3xl font-semibold tracking-tight">Předplatné</h1>
    <%= link_to "Zpět na úvod", root_path, class: "text-sm font-medium text-gray-900 hover:underline" %>
  </div>

  <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-2">
    <% @subscription_plans.each do |plan| %>
      <div class="group rounded-2xl border border-gray-200 bg-white p-6 shadow-sm hover:border-gray-300">
        <div class="flex flex-col gap-3">
          <% if plan.cover_image.attached? %>
            <% thumb = (plan.cover_image.variant(resize_to_fill: [1200, 675]).processed rescue nil) %>
            <%= link_to subscription_plan_path(plan.slug), class: "overflow-hidden rounded-2xl border border-gray-200 bg-white" do %>
              <% if thumb %>
                <%= image_tag thumb, class: "h-40 w-full object-cover" %>
              <% else %>
                <%= image_tag rails_blob_path(plan.cover_image, disposition: "inline"), class: "h-40 w-full object-cover" %>
              <% end %>
            <% end %>
          <% end %>
          <div class="flex items-start justify-between gap-4">
            <div>
              <h2 class="text-lg font-semibold tracking-tight">
                <%= link_to plan.name, subscription_plan_path(plan.slug), class: "hover:underline" %>
              </h2>
              <p class="mt-1 text-xs text-gray-600">od <%= plan.author.name %></p>
            </div>
            <span class="shrink-0 rounded-full bg-gray-100 px-3 py-1 text-xs font-medium text-gray-700">
              od <%= number_to_currency(plan.monthly_price, unit: plan.currency, precision: plan.display_precision) %>/měs
            </span>
          </div>
          <% if plan.description&.body&.present? %>
            <div class="prose prose-sm prose-gray max-w-none">
              <%= plan.description %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <% if @subscription_plans.empty? %>
    <div class="mt-6 rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-8 text-gray-700">
      Zatím nejsou k dispozici žádné předplatné plány.
    </div>
  <% end %>
</div>
